2025-02-09 16:00:05.088 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__currentDate_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT c.commande_id, c.client_id, c.date_creation, c.date_expiration, c.facture_id, c.livraison_id, c.valide
FROM commande AS c
WHERE NOT (c.valide) AND c.date_expiration < @__currentDate_0
2025-02-09 16:00:05.102 +01:00 [INF] Aucun panier expiré à supprimer.
2025-02-09 16:13:00.524 +01:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5141/api/Panier/extend/66 - null 0
2025-02-09 16:13:00.527 +01:00 [INF] CORS policy execution successful.
2025-02-09 16:13:00.527 +01:00 [INF] Executing endpoint 'backend_negosud.Controllers.PanierController.ExtendBasketDuration (backend-negosud)'
2025-02-09 16:13:00.537 +01:00 [INF] Route matched with {action = "ExtendBasketDuration", controller = "Panier"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtendBasketDuration(Int32) on controller backend_negosud.Controllers.PanierController (backend-negosud).
2025-02-09 16:13:00.547 +01:00 [INF] Executing action method backend_negosud.Controllers.PanierController.ExtendBasketDuration (backend-negosud) - Validation state: "Valid"
2025-02-09 16:13:00.598 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__clientId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.commande_id, t.client_id, t.date_creation, t.date_expiration, t.facture_id, t.livraison_id, t.valide, t0.ligne_commande_id, t0.article_id, t0.commande_id, t0.quantite, t0.article_id0, t0.famille_id, t0.fournisseur_id, t0.libelle, t0.prix, t0.reference, t0.tva_id
FROM (
    SELECT c.commande_id, c.client_id, c.date_creation, c.date_expiration, c.facture_id, c.livraison_id, c.valide
    FROM commande AS c
    WHERE c.client_id = @__clientId_0 AND NOT (c.valide)
    ORDER BY c.date_creation DESC
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT l.ligne_commande_id, l.article_id, l.commande_id, l.quantite, a.article_id AS article_id0, a.famille_id, a.fournisseur_id, a.libelle, a.prix, a.reference, a.tva_id
    FROM ligne_commande AS l
    INNER JOIN article AS a ON l.article_id = a.article_id
) AS t0 ON t.commande_id = t0.commande_id
ORDER BY t.date_creation DESC, t.commande_id, t0.ligne_commande_id
2025-02-09 16:13:00.599 +01:00 [WRN] Aucun panier actif trouvé pour le client avec l'ID: 66
2025-02-09 16:13:00.599 +01:00 [INF] Executed action method backend_negosud.Controllers.PanierController.ExtendBasketDuration (backend-negosud), returned result Microsoft.AspNetCore.Mvc.BadRequestObjectResult in 51.4083ms.
2025-02-09 16:13:00.600 +01:00 [INF] Executing BadRequestObjectResult, writing value of type 'backend_negosud.Models.ResponseDataModel`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-09 16:13:00.606 +01:00 [INF] Executed action backend_negosud.Controllers.PanierController.ExtendBasketDuration (backend-negosud) in 68.646ms
2025-02-09 16:13:00.606 +01:00 [INF] Executed endpoint 'backend_negosud.Controllers.PanierController.ExtendBasketDuration (backend-negosud)'
2025-02-09 16:13:00.607 +01:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5141/api/Panier/extend/66 - 400 null application/json; charset=utf-8 83.3709ms
2025-02-09 16:13:10.094 +01:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5141/api/Panier/extend/2 - null 0
2025-02-09 16:13:10.095 +01:00 [INF] CORS policy execution successful.
2025-02-09 16:13:10.095 +01:00 [INF] Executing endpoint 'backend_negosud.Controllers.PanierController.ExtendBasketDuration (backend-negosud)'
2025-02-09 16:13:10.097 +01:00 [INF] Route matched with {action = "ExtendBasketDuration", controller = "Panier"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtendBasketDuration(Int32) on controller backend_negosud.Controllers.PanierController (backend-negosud).
2025-02-09 16:13:10.098 +01:00 [INF] Executing action method backend_negosud.Controllers.PanierController.ExtendBasketDuration (backend-negosud) - Validation state: "Valid"
2025-02-09 16:13:10.112 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__clientId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.commande_id, t.client_id, t.date_creation, t.date_expiration, t.facture_id, t.livraison_id, t.valide, t0.ligne_commande_id, t0.article_id, t0.commande_id, t0.quantite, t0.article_id0, t0.famille_id, t0.fournisseur_id, t0.libelle, t0.prix, t0.reference, t0.tva_id
FROM (
    SELECT c.commande_id, c.client_id, c.date_creation, c.date_expiration, c.facture_id, c.livraison_id, c.valide
    FROM commande AS c
    WHERE c.client_id = @__clientId_0 AND NOT (c.valide)
    ORDER BY c.date_creation DESC
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT l.ligne_commande_id, l.article_id, l.commande_id, l.quantite, a.article_id AS article_id0, a.famille_id, a.fournisseur_id, a.libelle, a.prix, a.reference, a.tva_id
    FROM ligne_commande AS l
    INNER JOIN article AS a ON l.article_id = a.article_id
) AS t0 ON t.commande_id = t0.commande_id
ORDER BY t.date_creation DESC, t.commande_id, t0.ligne_commande_id
2025-02-09 16:13:10.118 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
UPDATE commande SET client_id = @p0, date_creation = @p1, date_expiration = @p2, facture_id = @p3, livraison_id = @p4, valide = @p5
WHERE commande_id = @p6;
2025-02-09 16:13:10.119 +01:00 [INF] Executed action method backend_negosud.Controllers.PanierController.ExtendBasketDuration (backend-negosud), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 20.0024ms.
2025-02-09 16:13:10.119 +01:00 [INF] Executing OkObjectResult, writing value of type 'backend_negosud.Models.ResponseDataModel`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-09 16:13:10.119 +01:00 [INF] Executed action backend_negosud.Controllers.PanierController.ExtendBasketDuration (backend-negosud) in 21.9575ms
2025-02-09 16:13:10.119 +01:00 [INF] Executed endpoint 'backend_negosud.Controllers.PanierController.ExtendBasketDuration (backend-negosud)'
2025-02-09 16:13:10.119 +01:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5141/api/Panier/extend/2 - 200 null application/json; charset=utf-8 25.1959ms
2025-02-09 16:13:29.021 +01:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5141/api/Panier/valid/2 - null 0
2025-02-09 16:13:29.023 +01:00 [INF] CORS policy execution successful.
2025-02-09 16:13:29.023 +01:00 [INF] Executing endpoint 'backend_negosud.Controllers.PanierController.BasketToCommand (backend-negosud)'
2025-02-09 16:13:29.026 +01:00 [INF] Route matched with {action = "BasketToCommand", controller = "Panier"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] BasketToCommand(Int32) on controller backend_negosud.Controllers.PanierController (backend-negosud).
2025-02-09 16:13:29.027 +01:00 [INF] Executing action method backend_negosud.Controllers.PanierController.BasketToCommand (backend-negosud) - Validation state: "Valid"
2025-02-09 16:13:29.030 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.commande_id, t.client_id, t.date_creation, t.date_expiration, t.facture_id, t.livraison_id, t.valide, t0.ligne_commande_id, t0.article_id, t0.commande_id, t0.quantite, t0.article_id0, t0.famille_id, t0.fournisseur_id, t0.libelle, t0.prix, t0.reference, t0.tva_id
FROM (
    SELECT c.commande_id, c.client_id, c.date_creation, c.date_expiration, c.facture_id, c.livraison_id, c.valide
    FROM commande AS c
    WHERE c.client_id = @__clientId_0 AND NOT (c.valide)
    ORDER BY c.date_creation DESC
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT l.ligne_commande_id, l.article_id, l.commande_id, l.quantite, a.article_id AS article_id0, a.famille_id, a.fournisseur_id, a.libelle, a.prix, a.reference, a.tva_id
    FROM ligne_commande AS l
    INNER JOIN article AS a ON l.article_id = a.article_id
) AS t0 ON t.commande_id = t0.commande_id
ORDER BY t.date_creation DESC, t.commande_id, t0.ligne_commande_id
2025-02-09 16:13:29.053 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = DateTime), @p2='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO livraison (date_estimee, date_livraison, livree)
VALUES (@p0, @p1, @p2)
RETURNING livraison_id;
2025-02-09 16:13:29.057 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@p9='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
UPDATE commande SET client_id = @p3, date_creation = @p4, date_expiration = @p5, facture_id = @p6, livraison_id = @p7, valide = @p8
WHERE commande_id = @p9;
2025-02-09 16:13:29.064 +01:00 [INF] Executed action method backend_negosud.Controllers.PanierController.BasketToCommand (backend-negosud), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 36.7362ms.
2025-02-09 16:13:29.064 +01:00 [INF] Executing OkObjectResult, writing value of type 'backend_negosud.Models.ResponseDataModel`1[[backend_negosud.DTOs.Commande_client.Outputs.CommandeOutputDto, backend-negosud, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-02-09 16:13:29.078 +01:00 [INF] Executed action backend_negosud.Controllers.PanierController.BasketToCommand (backend-negosud) in 51.5392ms
2025-02-09 16:13:29.078 +01:00 [INF] Executed endpoint 'backend_negosud.Controllers.PanierController.BasketToCommand (backend-negosud)'
2025-02-09 16:13:29.078 +01:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5141/api/Panier/valid/2 - 200 null application/json; charset=utf-8 56.798ms
2025-02-09 16:30:05.160 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__currentDate_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT c.commande_id, c.client_id, c.date_creation, c.date_expiration, c.facture_id, c.livraison_id, c.valide
FROM commande AS c
WHERE NOT (c.valide) AND c.date_expiration < @__currentDate_0
2025-02-09 16:30:05.161 +01:00 [INF] Aucun panier expiré à supprimer.
