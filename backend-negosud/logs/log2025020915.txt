2025-02-09 15:00:07.285 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__currentDate_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT c.commande_id, c.client_id, c.date_creation, c.date_expiration, c.facture_id, c.livraison_id, c.valide
FROM commande AS c
WHERE NOT (c.valide) AND c.date_expiration < @__currentDate_0
2025-02-09 15:00:07.290 +01:00 [INF] Aucun panier expiré à supprimer.
2025-02-09 15:01:11.937 +01:00 [INF] Server macbookpro:68989:eca21049 caught stopping signal...
2025-02-09 15:01:11.941 +01:00 [INF] Application is shutting down...
2025-02-09 15:01:11.942 +01:00 [INF] Server macbookpro:68989:bba4b873 caught stopping signal...
2025-02-09 15:01:11.947 +01:00 [INF] Server macbookpro:68989:eca21049 All dispatchers stopped
2025-02-09 15:01:11.947 +01:00 [INF] Server macbookpro:68989:bba4b873 All dispatchers stopped
2025-02-09 15:01:11.950 +01:00 [INF] Server macbookpro:68989:eca21049 successfully reported itself as stopped in 0,4537 ms
2025-02-09 15:01:11.950 +01:00 [INF] Server macbookpro:68989:bba4b873 successfully reported itself as stopped in 0,4421 ms
2025-02-09 15:01:11.950 +01:00 [INF] Server macbookpro:68989:eca21049 has been stopped in total 10,7688 ms
2025-02-09 15:01:11.950 +01:00 [INF] Server macbookpro:68989:bba4b873 has been stopped in total 7,7707 ms
2025-02-09 15:01:16.695 +01:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM client AS c)
2025-02-09 15:01:16.786 +01:00 [INF] Starting Hangfire Server using job storage: 'Hangfire.MemoryStorage.MemoryStorage'
2025-02-09 15:01:16.787 +01:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-02-09 15:01:16.827 +01:00 [INF] Server macbookpro:69466:b79c9d3f successfully announced in 31,437 ms
2025-02-09 15:01:16.829 +01:00 [INF] Server macbookpro:69466:b79c9d3f is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-02-09 15:01:16.831 +01:00 [INF] Server macbookpro:69466:b79c9d3f all the dispatchers started
2025-02-09 15:01:16.869 +01:00 [INF] User profile is available. Using '/Users/yoann/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2025-02-09 15:01:16.897 +01:00 [INF] Now listening on: http://localhost:5141
2025-02-09 15:01:16.898 +01:00 [INF] Starting Hangfire Server using job storage: 'Hangfire.MemoryStorage.MemoryStorage'
2025-02-09 15:01:16.898 +01:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-02-09 15:01:16.898 +01:00 [INF] Server macbookpro:69466:02e5671e successfully announced in 0,0562 ms
2025-02-09 15:01:16.899 +01:00 [INF] Server macbookpro:69466:02e5671e is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-02-09 15:01:16.900 +01:00 [INF] Server macbookpro:69466:02e5671e all the dispatchers started
2025-02-09 15:01:16.900 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-09 15:01:16.901 +01:00 [INF] Hosting environment: Development
2025-02-09 15:01:16.901 +01:00 [INF] Content root path: /Users/yoann/Workspace/CESI DI 2023/Negosud/backend/backend-negosud
2025-02-09 15:01:17.615 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5141/swagger/index.html - null null
2025-02-09 15:01:17.751 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5141/swagger/index.html - 200 null text/html;charset=utf-8 136.4469ms
2025-02-09 15:01:18.009 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5141/swagger/v1/swagger.json - null null
2025-02-09 15:01:18.084 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5141/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 75.4605ms
2025-02-09 15:01:21.468 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5141/api/Article - null null
2025-02-09 15:01:21.504 +01:00 [WRN] Failed to determine the https port for redirect.
2025-02-09 15:01:21.526 +01:00 [INF] Executing endpoint 'backend_negosud.Controllers.ArticleController.GetArticles (backend-negosud)'
2025-02-09 15:01:21.537 +01:00 [INF] Route matched with {action = "GetArticles", controller = "Article"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetArticles() on controller backend_negosud.Controllers.ArticleController (backend-negosud).
2025-02-09 15:01:21.628 +01:00 [INF] Executing action method backend_negosud.Controllers.ArticleController.GetArticles (backend-negosud) - Validation state: "Valid"
2025-02-09 15:01:21.753 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT a.article_id, a.famille_id, a.fournisseur_id, a.libelle, a.prix, a.reference, a.tva_id, f.famille_id, f.nom, f0.fournisseur_id, f0.email, f0.nom, f0.raison_sociale, f0.tel, t.tva_id, t.valeur
FROM article AS a
INNER JOIN famille AS f ON a.famille_id = f.famille_id
INNER JOIN fournisseur AS f0 ON a.fournisseur_id = f0.fournisseur_id
INNER JOIN tva AS t ON a.tva_id = t.tva_id
2025-02-09 15:01:21.824 +01:00 [INF] Executed action method backend_negosud.Controllers.ArticleController.GetArticles (backend-negosud), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 193.5617ms.
2025-02-09 15:01:21.831 +01:00 [INF] Executing OkObjectResult, writing value of type 'backend_negosud.Models.ResponseDataModel`1[[System.Collections.Generic.List`1[[backend_negosud.DTOs.Article.ArticleOutputDto.ArticleEssentialOutputDto, backend-negosud, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-09 15:01:21.895 +01:00 [INF] Executed action backend_negosud.Controllers.ArticleController.GetArticles (backend-negosud) in 355.643ms
2025-02-09 15:01:21.896 +01:00 [INF] Executed endpoint 'backend_negosud.Controllers.ArticleController.GetArticles (backend-negosud)'
2025-02-09 15:01:21.902 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5141/api/Article - 200 null application/json; charset=utf-8 434.3902ms
2025-02-09 15:07:06.936 +01:00 [INF] Server macbookpro:69466:02e5671e caught stopping signal...
2025-02-09 15:07:06.940 +01:00 [INF] Application is shutting down...
2025-02-09 15:07:06.940 +01:00 [INF] Server macbookpro:69466:b79c9d3f caught stopping signal...
2025-02-09 15:07:06.944 +01:00 [INF] Server macbookpro:69466:02e5671e All dispatchers stopped
2025-02-09 15:07:06.945 +01:00 [INF] Server macbookpro:69466:b79c9d3f All dispatchers stopped
2025-02-09 15:07:06.947 +01:00 [INF] Server macbookpro:69466:b79c9d3f successfully reported itself as stopped in 0,783 ms
2025-02-09 15:07:06.947 +01:00 [INF] Server macbookpro:69466:02e5671e successfully reported itself as stopped in 0,7989 ms
2025-02-09 15:07:06.948 +01:00 [INF] Server macbookpro:69466:b79c9d3f has been stopped in total 6,9057 ms
2025-02-09 15:07:06.948 +01:00 [INF] Server macbookpro:69466:02e5671e has been stopped in total 9,9023 ms
2025-02-09 15:07:10.905 +01:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM client AS c)
2025-02-09 15:07:10.998 +01:00 [INF] Starting Hangfire Server using job storage: 'Hangfire.MemoryStorage.MemoryStorage'
2025-02-09 15:07:10.999 +01:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-02-09 15:07:11.035 +01:00 [INF] Server macbookpro:69865:b71f6a63 successfully announced in 29,7804 ms
2025-02-09 15:07:11.037 +01:00 [INF] Server macbookpro:69865:b71f6a63 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-02-09 15:07:11.039 +01:00 [INF] Server macbookpro:69865:b71f6a63 all the dispatchers started
2025-02-09 15:07:11.079 +01:00 [INF] User profile is available. Using '/Users/yoann/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2025-02-09 15:07:11.108 +01:00 [INF] Now listening on: http://localhost:5141
2025-02-09 15:07:11.108 +01:00 [INF] Starting Hangfire Server using job storage: 'Hangfire.MemoryStorage.MemoryStorage'
2025-02-09 15:07:11.108 +01:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-02-09 15:07:11.109 +01:00 [INF] Server macbookpro:69865:d99ba7d6 successfully announced in 0,0799 ms
2025-02-09 15:07:11.109 +01:00 [INF] Server macbookpro:69865:d99ba7d6 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-02-09 15:07:11.110 +01:00 [INF] Server macbookpro:69865:d99ba7d6 all the dispatchers started
2025-02-09 15:07:11.111 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-09 15:07:11.111 +01:00 [INF] Hosting environment: Development
2025-02-09 15:07:11.111 +01:00 [INF] Content root path: /Users/yoann/Workspace/CESI DI 2023/Negosud/backend/backend-negosud
2025-02-09 15:07:11.745 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5141/swagger/index.html - null null
2025-02-09 15:07:11.872 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5141/swagger/index.html - 200 null text/html;charset=utf-8 126.9235ms
2025-02-09 15:07:12.165 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5141/swagger/v1/swagger.json - null null
2025-02-09 15:07:12.277 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5141/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 112.4496ms
2025-02-09 15:07:22.713 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5141/api/Article/2 - null null
2025-02-09 15:07:22.741 +01:00 [WRN] Failed to determine the https port for redirect.
2025-02-09 15:07:22.766 +01:00 [INF] Executing endpoint 'backend_negosud.Controllers.ArticleController.GetArticleById (backend-negosud)'
2025-02-09 15:07:22.782 +01:00 [INF] Route matched with {action = "GetArticleById", controller = "Article"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetArticleById(Int32) on controller backend_negosud.Controllers.ArticleController (backend-negosud).
2025-02-09 15:07:22.887 +01:00 [INF] Executing action method backend_negosud.Controllers.ArticleController.GetArticleById (backend-negosud) - Validation state: "Valid"
2025-02-09 15:07:23.034 +01:00 [INF] Executed DbCommand (19ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.article_id, a.famille_id, a.fournisseur_id, a.libelle, a.prix, a.reference, a.tva_id, f.famille_id, f.nom, f0.fournisseur_id, f0.email, f0.nom, f0.raison_sociale, f0.tel, t.tva_id, t.valeur
FROM article AS a
INNER JOIN famille AS f ON a.famille_id = f.famille_id
INNER JOIN fournisseur AS f0 ON a.fournisseur_id = f0.fournisseur_id
INNER JOIN tva AS t ON a.tva_id = t.tva_id
WHERE a.article_id = @__id_0
LIMIT 1
2025-02-09 15:07:23.119 +01:00 [INF] Executed action method backend_negosud.Controllers.ArticleController.GetArticleById (backend-negosud), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 229.7142ms.
2025-02-09 15:07:23.127 +01:00 [INF] Executing OkObjectResult, writing value of type 'backend_negosud.Models.ResponseDataModel`1[[backend_negosud.DTOs.Article.ArticleOutputDto.ArticleEssentialOutputDto, backend-negosud, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-02-09 15:07:23.204 +01:00 [INF] Executed action backend_negosud.Controllers.ArticleController.GetArticleById (backend-negosud) in 419.6032ms
2025-02-09 15:07:23.205 +01:00 [INF] Executed endpoint 'backend_negosud.Controllers.ArticleController.GetArticleById (backend-negosud)'
2025-02-09 15:07:23.212 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5141/api/Article/2 - 200 null application/json; charset=utf-8 498.6671ms
2025-02-09 15:30:02.319 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__currentDate_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT c.commande_id, c.client_id, c.date_creation, c.date_expiration, c.facture_id, c.livraison_id, c.valide
FROM commande AS c
WHERE NOT (c.valide) AND c.date_expiration < @__currentDate_0
2025-02-09 15:30:02.323 +01:00 [INF] Aucun panier expiré à supprimer.
2025-02-09 15:51:37.741 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5141/api/Panier/create - application/json 102
2025-02-09 15:51:37.754 +01:00 [INF] CORS policy execution successful.
2025-02-09 15:51:37.756 +01:00 [INF] Executing endpoint 'backend_negosud.Controllers.PanierController.CreateBasket (backend-negosud)'
2025-02-09 15:51:37.763 +01:00 [INF] Route matched with {action = "CreateBasket", controller = "Panier"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateBasket(backend_negosud.DTOs.Commande_client.PanierInputDto) on controller backend_negosud.Controllers.PanierController (backend-negosud).
2025-02-09 15:51:37.807 +01:00 [INF] Executing action method backend_negosud.Controllers.PanierController.CreateBasket (backend-negosud) - Validation state: "Valid"
2025-02-09 15:51:37.810 +01:00 [INF] Tentative de récupération du client avec ID: 2
2025-02-09 15:51:37.878 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.client_id, c.acess_token, c.email, c.est_valide, c.mot_de_passe, c.nom, c.prenom, c.tel
FROM client AS c
WHERE c.client_id = @__p_0
LIMIT 1
2025-02-09 15:51:37.905 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__ligne_ArticleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM article AS a
    WHERE a.article_id = @__ligne_ArticleId_0)
2025-02-09 15:51:38.020 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO commande (client_id, date_creation, date_expiration, facture_id, livraison_id, valide)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5)
RETURNING commande_id;
2025-02-09 15:51:38.034 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO ligne_commande (article_id, commande_id, quantite)
VALUES (@p6, @p7, @p8)
RETURNING ligne_commande_id;
2025-02-09 15:51:38.085 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.commande_id, t.client_id, t.date_creation, t.date_expiration, t.facture_id, t.livraison_id, t.valide, t0.ligne_commande_id, t0.article_id, t0.commande_id, t0.quantite, t0.article_id0, t0.famille_id, t0.fournisseur_id, t0.libelle, t0.prix, t0.reference, t0.tva_id
FROM (
    SELECT c.commande_id, c.client_id, c.date_creation, c.date_expiration, c.facture_id, c.livraison_id, c.valide
    FROM commande AS c
    WHERE c.commande_id = @__id_0
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT l.ligne_commande_id, l.article_id, l.commande_id, l.quantite, a.article_id AS article_id0, a.famille_id, a.fournisseur_id, a.libelle, a.prix, a.reference, a.tva_id
    FROM ligne_commande AS l
    INNER JOIN article AS a ON l.article_id = a.article_id
) AS t0 ON t.commande_id = t0.commande_id
ORDER BY t.commande_id, t0.ligne_commande_id
2025-02-09 15:51:38.094 +01:00 [INF] Executed action method backend_negosud.Controllers.PanierController.CreateBasket (backend-negosud), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 286.8213ms.
2025-02-09 15:51:38.095 +01:00 [INF] Executing OkObjectResult, writing value of type 'backend_negosud.Models.ResponseDataModel`1[[backend_negosud.DTOs.Commande_client.Outputs.PanierOutputDto, backend-negosud, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-02-09 15:51:38.107 +01:00 [INF] Executed action backend_negosud.Controllers.PanierController.CreateBasket (backend-negosud) in 343.8614ms
2025-02-09 15:51:38.107 +01:00 [INF] Executed endpoint 'backend_negosud.Controllers.PanierController.CreateBasket (backend-negosud)'
2025-02-09 15:51:38.107 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5141/api/Panier/create - 200 null application/json; charset=utf-8 365.9952ms
2025-02-09 15:52:54.173 +01:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5141/api/Panier/update - application/json 148
2025-02-09 15:52:54.180 +01:00 [INF] CORS policy execution successful.
2025-02-09 15:52:54.187 +01:00 [INF] Executing endpoint 'backend_negosud.Controllers.PanierController.UpdateBasket (backend-negosud)'
2025-02-09 15:52:54.195 +01:00 [INF] Route matched with {action = "UpdateBasket", controller = "Panier"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateBasket(backend_negosud.DTOs.Commande_client.PanierUpdateInputDto) on controller backend_negosud.Controllers.PanierController (backend-negosud).
2025-02-09 15:52:54.203 +01:00 [INF] Executing action method backend_negosud.Controllers.PanierController.UpdateBasket (backend-negosud) - Validation state: "Valid"
2025-02-09 15:52:54.205 +01:00 [ERR] ClientId est invalide.
2025-02-09 15:52:54.206 +01:00 [INF] Executed action method backend_negosud.Controllers.PanierController.UpdateBasket (backend-negosud), returned result Microsoft.AspNetCore.Mvc.BadRequestObjectResult in 2.5136ms.
2025-02-09 15:52:54.206 +01:00 [INF] Executing BadRequestObjectResult, writing value of type 'backend_negosud.Models.ResponseDataModel`1[[backend_negosud.DTOs.Commande_client.Outputs.PanierOutputDto, backend-negosud, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-02-09 15:52:54.206 +01:00 [INF] Executed action backend_negosud.Controllers.PanierController.UpdateBasket (backend-negosud) in 10.2454ms
2025-02-09 15:52:54.206 +01:00 [INF] Executed endpoint 'backend_negosud.Controllers.PanierController.UpdateBasket (backend-negosud)'
2025-02-09 15:52:54.207 +01:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5141/api/Panier/update - 400 null application/json; charset=utf-8 34.6675ms
2025-02-09 15:53:09.367 +01:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5141/api/Panier/update - application/json 148
2025-02-09 15:53:09.371 +01:00 [INF] CORS policy execution successful.
2025-02-09 15:53:09.372 +01:00 [INF] Executing endpoint 'backend_negosud.Controllers.PanierController.UpdateBasket (backend-negosud)'
2025-02-09 15:53:09.372 +01:00 [INF] Route matched with {action = "UpdateBasket", controller = "Panier"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateBasket(backend_negosud.DTOs.Commande_client.PanierUpdateInputDto) on controller backend_negosud.Controllers.PanierController (backend-negosud).
2025-02-09 15:53:09.389 +01:00 [INF] Executing action method backend_negosud.Controllers.PanierController.UpdateBasket (backend-negosud) - Validation state: "Valid"
2025-02-09 15:53:09.389 +01:00 [INF] Tentative de récupération du client avec ID: 2
2025-02-09 15:53:09.396 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.client_id, c.acess_token, c.email, c.est_valide, c.mot_de_passe, c.nom, c.prenom, c.tel
FROM client AS c
WHERE c.client_id = @__p_0
LIMIT 1
2025-02-09 15:53:09.399 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.commande_id, t.client_id, t.date_creation, t.date_expiration, t.facture_id, t.livraison_id, t.valide, t0.ligne_commande_id, t0.article_id, t0.commande_id, t0.quantite, t0.article_id0, t0.famille_id, t0.fournisseur_id, t0.libelle, t0.prix, t0.reference, t0.tva_id
FROM (
    SELECT c.commande_id, c.client_id, c.date_creation, c.date_expiration, c.facture_id, c.livraison_id, c.valide
    FROM commande AS c
    WHERE c.commande_id = @__id_0
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT l.ligne_commande_id, l.article_id, l.commande_id, l.quantite, a.article_id AS article_id0, a.famille_id, a.fournisseur_id, a.libelle, a.prix, a.reference, a.tva_id
    FROM ligne_commande AS l
    INNER JOIN article AS a ON l.article_id = a.article_id
) AS t0 ON t.commande_id = t0.commande_id
ORDER BY t.commande_id, t0.ligne_commande_id
2025-02-09 15:53:09.410 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__newLigneDto_ArticleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM article AS a
    WHERE a.article_id = @__newLigneDto_ArticleId_0)
2025-02-09 15:53:09.449 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Boolean), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
UPDATE commande SET client_id = @p0, date_creation = @p1, date_expiration = @p2, facture_id = @p3, livraison_id = @p4, valide = @p5
WHERE commande_id = @p6;
DELETE FROM ligne_commande
WHERE ligne_commande_id = @p7;
INSERT INTO ligne_commande (article_id, commande_id, quantite)
VALUES (@p8, @p9, @p10)
RETURNING ligne_commande_id;
2025-02-09 15:53:09.455 +01:00 [INF] Executed action method backend_negosud.Controllers.PanierController.UpdateBasket (backend-negosud), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 66.0915ms.
2025-02-09 15:53:09.455 +01:00 [INF] Executing OkObjectResult, writing value of type 'backend_negosud.Models.ResponseDataModel`1[[backend_negosud.DTOs.Commande_client.Outputs.PanierOutputDto, backend-negosud, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-02-09 15:53:09.455 +01:00 [INF] Executed action backend_negosud.Controllers.PanierController.UpdateBasket (backend-negosud) in 82.6347ms
2025-02-09 15:53:09.456 +01:00 [INF] Executed endpoint 'backend_negosud.Controllers.PanierController.UpdateBasket (backend-negosud)'
2025-02-09 15:53:09.456 +01:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5141/api/Panier/update - 200 null application/json; charset=utf-8 88.4902ms
2025-02-09 15:53:40.744 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5141/api/Panier/66 - null null
2025-02-09 15:53:40.749 +01:00 [INF] Executing endpoint 'backend_negosud.Controllers.PanierController.GetBasketClient (backend-negosud)'
2025-02-09 15:53:40.760 +01:00 [INF] Route matched with {action = "GetBasketClient", controller = "Panier"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetBasketClient(Int32) on controller backend_negosud.Controllers.PanierController (backend-negosud).
2025-02-09 15:53:40.761 +01:00 [INF] Executing action method backend_negosud.Controllers.PanierController.GetBasketClient (backend-negosud) - Validation state: "Valid"
2025-02-09 15:53:40.776 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__clientId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.commande_id, t.client_id, t.date_creation, t.date_expiration, t.facture_id, t.livraison_id, t.valide, t0.ligne_commande_id, t0.article_id, t0.commande_id, t0.quantite, t0.article_id0, t0.famille_id, t0.fournisseur_id, t0.libelle, t0.prix, t0.reference, t0.tva_id
FROM (
    SELECT c.commande_id, c.client_id, c.date_creation, c.date_expiration, c.facture_id, c.livraison_id, c.valide
    FROM commande AS c
    WHERE c.client_id = @__clientId_0 AND NOT (c.valide)
    ORDER BY c.date_creation DESC
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT l.ligne_commande_id, l.article_id, l.commande_id, l.quantite, a.article_id AS article_id0, a.famille_id, a.fournisseur_id, a.libelle, a.prix, a.reference, a.tva_id
    FROM ligne_commande AS l
    INNER JOIN article AS a ON l.article_id = a.article_id
) AS t0 ON t.commande_id = t0.commande_id
ORDER BY t.date_creation DESC, t.commande_id, t0.ligne_commande_id
2025-02-09 15:53:40.777 +01:00 [WRN] Aucun panier actif trouvé pour le client avec l'ID: 66
2025-02-09 15:53:40.777 +01:00 [INF] Executed action method backend_negosud.Controllers.PanierController.GetBasketClient (backend-negosud), returned result Microsoft.AspNetCore.Mvc.BadRequestObjectResult in 16.3602ms.
2025-02-09 15:53:40.777 +01:00 [INF] Executing BadRequestObjectResult, writing value of type 'backend_negosud.Models.ResponseDataModel`1[[backend_negosud.DTOs.Commande_client.Outputs.PanierOutputDto, backend-negosud, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-02-09 15:53:40.778 +01:00 [INF] Executed action backend_negosud.Controllers.PanierController.GetBasketClient (backend-negosud) in 17.3652ms
2025-02-09 15:53:40.778 +01:00 [INF] Executed endpoint 'backend_negosud.Controllers.PanierController.GetBasketClient (backend-negosud)'
2025-02-09 15:53:40.778 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5141/api/Panier/66 - 400 null application/json; charset=utf-8 33.8952ms
2025-02-09 15:53:48.454 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5141/api/Panier/2 - null null
2025-02-09 15:53:48.454 +01:00 [INF] Executing endpoint 'backend_negosud.Controllers.PanierController.GetBasketClient (backend-negosud)'
2025-02-09 15:53:48.456 +01:00 [INF] Route matched with {action = "GetBasketClient", controller = "Panier"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetBasketClient(Int32) on controller backend_negosud.Controllers.PanierController (backend-negosud).
2025-02-09 15:53:48.459 +01:00 [INF] Executing action method backend_negosud.Controllers.PanierController.GetBasketClient (backend-negosud) - Validation state: "Valid"
2025-02-09 15:53:48.465 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__clientId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.commande_id, t.client_id, t.date_creation, t.date_expiration, t.facture_id, t.livraison_id, t.valide, t0.ligne_commande_id, t0.article_id, t0.commande_id, t0.quantite, t0.article_id0, t0.famille_id, t0.fournisseur_id, t0.libelle, t0.prix, t0.reference, t0.tva_id
FROM (
    SELECT c.commande_id, c.client_id, c.date_creation, c.date_expiration, c.facture_id, c.livraison_id, c.valide
    FROM commande AS c
    WHERE c.client_id = @__clientId_0 AND NOT (c.valide)
    ORDER BY c.date_creation DESC
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT l.ligne_commande_id, l.article_id, l.commande_id, l.quantite, a.article_id AS article_id0, a.famille_id, a.fournisseur_id, a.libelle, a.prix, a.reference, a.tva_id
    FROM ligne_commande AS l
    INNER JOIN article AS a ON l.article_id = a.article_id
) AS t0 ON t.commande_id = t0.commande_id
ORDER BY t.date_creation DESC, t.commande_id, t0.ligne_commande_id
2025-02-09 15:53:48.465 +01:00 [INF] Executed action method backend_negosud.Controllers.PanierController.GetBasketClient (backend-negosud), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 5.8936ms.
2025-02-09 15:53:48.465 +01:00 [INF] Executing OkObjectResult, writing value of type 'backend_negosud.Models.ResponseDataModel`1[[backend_negosud.DTOs.Commande_client.Outputs.PanierOutputDto, backend-negosud, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-02-09 15:53:48.466 +01:00 [INF] Executed action backend_negosud.Controllers.PanierController.GetBasketClient (backend-negosud) in 7.871ms
2025-02-09 15:53:48.466 +01:00 [INF] Executed endpoint 'backend_negosud.Controllers.PanierController.GetBasketClient (backend-negosud)'
2025-02-09 15:53:48.466 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5141/api/Panier/2 - 200 null application/json; charset=utf-8 12.0463ms
